{"openapi":"3.1.0","info":{"title":"BIG Auth","version":"1.0"},"components":{"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer"}},"schemas":{},"parameters":{}},"paths":{"/send-code":{"post":{"tags":["auth"],"summary":"Send OTP","operationId":"post_SendCodeHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"phoneNumber":{"type":"string","example":"+99999999999"}},"required":["phoneNumber"]}}}},"responses":{"200":{"description":"Message sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/verify-code":{"post":{"tags":["auth"],"summary":"Verify OTP","operationId":"post_VerifyCodeHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"phoneNumber":{"type":"string","example":"+99901234567"},"code":{"type":"string","example":"000000"}},"required":["phoneNumber","code"]}}}},"responses":{"200":{"description":"OTP verification successful","content":{"application/json":{"schema":{"type":"object","properties":{"accessToken":{"type":"string","example":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJGLXl1Z01uN1A1d0RNYmpjcGVaN1AiLCJwaG9uZSI6MzQ2MjcwNjg0NzgsIm5iZiI6MTcwODgxNzY0OSwiZXhwIjoxNzExNDA5NjQ5LCJpYXQiOjE3MDg4MTc2NDl9.FAqILei0iXB0lAZP41hUYZTnLZcHQX2O560P9YM4QGQ"},"refreshToken":{"type":"string","example":"TnLZcHQX2O560P9YM4QGQ"}},"required":["accessToken","refreshToken"]}}}},"400":{"description":"incorrect code","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"incorrect code"}},"required":["error"]}}}}}}},"/auth/refresh":{"post":{"summary":"Refresh tokens","tags":["auth"],"security":[],"operationId":"post_RefreshTokenHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"refreshToken":{"type":"string"}},"required":["refreshToken"]}}}},"responses":{"200":{"description":"ok","content":{"application/json":{"schema":{"type":"object","properties":{"accessToken":{"type":"string"},"refreshToken":{"type":"string"}},"required":["accessToken","refreshToken"]}}}},"400":{"description":"Bad Request"},"401":{"description":"Unauthorized"},"500":{"description":"Server Error"}}}},"/profile/{id}":{"get":{"summary":"Get user profile","operationId":"user profule","tags":["contacts"],"security":[{"BearerAuth":[]}],"parameters":[{"schema":{"type":"string"},"required":true,"name":"id","in":"path"}],"responses":{"200":{"description":"Profile fetched successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"weEEwwecw_wdx2"},"phoneNumber":{"type":"string","example":"+79333333333"},"username":{"type":"string","example":"@ask_uznetsov"},"firstName":{"type":"string","example":"Aleksandr"},"lastName":{"type":"string","example":"Ivanov"},"avatarUrl":{"type":"string","example":"https://pics.png/png.png"}},"required":["id","phoneNumber"]}}}}}}},"/profile":{"get":{"summary":"Get own profile","tags":["profile"],"operationId":"own profile","security":[{"BearerAuth":[]}],"responses":{"200":{"description":"Profile fetched successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"weEEwwecw_wdx2"},"phoneNumber":{"type":"string","example":"+79333333333"},"username":{"type":"string","example":"@ask_uznetsov"},"firstName":{"type":"string","example":"Aleksandr"},"lastName":{"type":"string","example":"Ivanov"},"avatarUrl":{"type":"string","example":"https://pics.png/png.png"}},"required":["id","phoneNumber"]}}}}}},"post":{"summary":"Update user profile","tags":["profile"],"security":[{"BearerAuth":[]}],"operationId":"post_UpdateProfileHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"username":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"avatarUrl":{"type":"string"}}}}}},"responses":{"200":{"description":"Profile updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","example":"weEEwwecw_wdx2"},"phoneNumber":{"type":"string","example":"+79333333333"},"username":{"type":"string","example":"@ask_uznetsov"},"firstName":{"type":"string","example":"Aleksandr"},"lastName":{"type":"string","example":"Ivanov"},"avatarUrl":{"type":"string","example":"https://pics.png/png.png"}},"required":["id","phoneNumber"]}}}},"400":{"description":"Bad Request"},"401":{"description":"Unauthorized"},"500":{"description":"Server Error"}}}},"/public/{id}":{"get":{"summary":"retrieve a file by id","tags":["files"],"operationId":"get_RetrieveFileHandler","parameters":[{"schema":{"type":"string"},"required":true,"name":"id","in":"path"}],"responses":{"200":{"description":"File retrieved successfully","content":{"application/json":{"schema":{"type":"string"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"id is required"}},"required":["error"]}}}},"404":{"description":"File not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"File not found"}},"required":["error"]}}}},"500":{"description":"Server Error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Failed to retrieve file"}},"required":["error"]}}}}}}},"/public/upload":{"post":{"summary":"Upload a file","tags":["files"],"operationId":"post_UploadFileHandler","responses":{"200":{"description":"File uploaded successfully","content":{"application/json":{"schema":{"type":"object","properties":{"url":{"type":"string","example":"https://dev.iambig.ai/public/zAE2h2mPSKjWwnxw8qxp4"}},"required":["url"]}}}},"400":{"description":"Bad Request"},"500":{"description":"Server Error"}}}},"/contacts/whoIsThere":{"post":{"summary":"Find contacts by phone numbers","tags":["contacts"],"security":[{"BearerAuth":[]}],"operationId":"post_FindContactsHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"phoneNumbers":{"type":"array","items":{"type":"string","example":"+99990123443"}}},"required":["phoneNumbers"]}}}},"responses":{"200":{"description":"Contacts found","content":{"application/json":{"schema":{"type":"object","properties":{"contacts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"phoneNumber":{"type":"string"},"username":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"avatarUrl":{"type":"string"}},"required":["id","phoneNumber"]}}},"required":["contacts"]}}}},"400":{"description":"Bad Request"},"500":{"description":"Server Error"}}}},"/messages":{"post":{"tags":["messages"],"summary":"Send a chat message ","security":[{"BearerAuth":[]}],"operationId":"post_SendMessageHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"chatId":{"type":"string","example":"JC0TvKi3f2bIQtBcW1jIn"},"attachments":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string","enum":["file","image","video"]},"id":{"type":"string"},"filename":{"type":"string"},"url":{"type":"string","format":"uri"},"meta":{"anyOf":[{"type":"object","properties":{"extension":{"type":"string"},"size":{"type":"number"}},"required":["extension","size"]},{"type":"object","properties":{"mimetype":{"type":"string"},"width":{"type":"number"},"height":{"type":"number"},"size":{"type":"number"}},"required":["mimetype","width","height","size"]},{"type":"object","properties":{"mimetype":{"type":"string"},"width":{"type":"number"},"height":{"type":"number"},"size":{"type":"number"},"duration":{"type":"number"}},"required":["mimetype","width","height","size","duration"]}]}},"required":["type","id","filename","url","meta"]}},"message":{"type":"string","example":"Hello, how are you?"},"clientMessageId":{"type":"string","example":"ldjkedlkedlk"}},"required":["chatId"]}}}},"responses":{"200":{"description":"Message sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"messageId":{"type":"number"},"timestamp":{"type":"number"}},"required":["messageId","timestamp"]}}}},"400":{"description":"Bad Request"},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"status":{"type":"string"}},"required":["error","status"]}}}}}},"get":{"summary":"Retrieve messages for a chat","tags":["messages"],"security":[{"BearerAuth":[]}],"operationId":"get_GetMessagesHandler","parameters":[{"schema":{"type":["string","null"],"description":"The ID of the chat"},"required":false,"description":"The ID of the chat","name":"chatId","in":"query"},{"schema":{"type":["number","null"],"maximum":500,"default":50,"description":"portion length"},"required":false,"description":"portion length","name":"count","in":"query"},{"schema":{"type":["number","null"],"description":"to id"},"required":false,"description":"to id","name":"endId","in":"query"}],"responses":{"200":{"description":"Messages retrieved successfully","content":{"application/json":{"schema":{"anyOf":[{"type":"array","items":{"type":"object","properties":{"messageId":{"type":"number"},"message":{"type":"string"},"sender":{"type":"string"},"attachments":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string","enum":["file","image","video"]},"id":{"type":"string"},"filename":{"type":"string"},"url":{"type":"string","format":"uri"},"meta":{"anyOf":[{"type":"object","properties":{"extension":{"type":"string"},"size":{"type":"number"}},"required":["extension","size"]},{"type":"object","properties":{"mimetype":{"type":"string"},"width":{"type":"number"},"height":{"type":"number"},"size":{"type":"number"}},"required":["mimetype","width","height","size"]},{"type":"object","properties":{"mimetype":{"type":"string"},"width":{"type":"number"},"height":{"type":"number"},"size":{"type":"number"},"duration":{"type":"number"}},"required":["mimetype","width","height","size","duration"]}]}},"required":["type","id","filename","url","meta"]}},"read":{"type":"number"},"dlvrd":{"type":"number"},"createdAt":{"type":"number"},"updatedAt":{"type":"number"},"deletedAt":{"type":"number"}},"required":["messageId","sender","createdAt"],"description":"DialogMessageSchema"}},{"type":"array","items":{"type":"object","properties":{"messageId":{"type":"number"},"message":{"type":"string"},"sender":{"type":"string"},"attachments":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string","enum":["file","image","video"]},"id":{"type":"string"},"filename":{"type":"string"},"url":{"type":"string","format":"uri"},"meta":{"anyOf":[{"type":"object","properties":{"extension":{"type":"string"},"size":{"type":"number"}},"required":["extension","size"]},{"type":"object","properties":{"mimetype":{"type":"string"},"width":{"type":"number"},"height":{"type":"number"},"size":{"type":"number"}},"required":["mimetype","width","height","size"]},{"type":"object","properties":{"mimetype":{"type":"string"},"width":{"type":"number"},"height":{"type":"number"},"size":{"type":"number"},"duration":{"type":"number"}},"required":["mimetype","width","height","size","duration"]}]}},"required":["type","id","filename","url","meta"]}},"delivering":{"type":"array","items":{"type":"object","properties":{"userId":{"type":"string"},"dlvrd":{"type":"number"},"read":{"type":"number"}},"required":["userId"]}},"createdAt":{"type":"number"},"updatedAt":{"type":"number"},"deletedAt":{"type":"number"}},"required":["messageId","sender","createdAt"],"description":"GroupChatMessageSchema"}}],"description":"Dialog or groupchat messages"}}}},"400":{"description":"Bad Request"},"401":{"description":"Unauthorized"},"500":{"description":"Internal Server Error"}}}},"/chat":{"get":{"summary":"Retrieve chat info","tags":["chats"],"security":[{"BearerAuth":[]}],"operationId":"get_GetChatHandler","parameters":[{"schema":{"type":["string","null"],"description":"The ID of the chat"},"required":false,"description":"The ID of the chat","name":"chatId","in":"query"}],"responses":{"200":{"description":"Chat retrieved successfully","content":{"application/json":{"schema":{"anyOf":[{"type":"object","properties":{"chatId":{"type":"string"},"photoUrl":{"type":"string"},"type":{"type":"string","enum":["dialog","group","channel"]},"name":{"type":"string"},"lastMessageId":{"type":"number"},"lastMessageText":{"type":"string"},"lastMessageTime":{"type":"number"},"lastMessageAuthor":{"type":"string"},"lastMessageStatus":{"type":"string","enum":["read","unread","undelivered","deleted"]},"missed":{"type":"number"},"verified":{"type":"boolean"},"isMine":{"type":"boolean"},"attachmentType":{"type":"string","enum":["file","image","video"]},"meta":{"type":"object","properties":{"name":{"type":"string"},"owner":{"type":"string"},"participants":{"type":"array","items":{"type":"string"}},"createdAt":{"type":"number"}},"required":["name","owner","participants","createdAt"]}},"required":["chatId","type","name","missed","meta"]},{"type":"object","properties":{"chatId":{"type":"string"},"photoUrl":{"type":"string"},"type":{"type":"string","enum":["dialog","group","channel"]},"name":{"type":"string"},"lastMessageId":{"type":"number"},"lastMessageText":{"type":"string"},"lastMessageTime":{"type":"number"},"lastMessageAuthor":{"type":"string"},"lastMessageStatus":{"type":"string","enum":["read","unread","undelivered","deleted"]},"missed":{"type":"number"},"verified":{"type":"boolean"},"isMine":{"type":"boolean"},"attachmentType":{"type":"string","enum":["file","image","video"]},"meta":{"type":"object","properties":{"firstName":{"type":"string"},"lastName":{"type":"string"},"username":{"type":"string"},"phoneNumber":{"type":"string"}}}},"required":["chatId","type","name","missed","meta"]}]}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal Server Error"}}}},"/chats":{"get":{"summary":"Retrieve chat messages","tags":["chats"],"security":[{"BearerAuth":[]}],"operationId":"get_GetChatsHandler","responses":{"200":{"description":"Chat messages retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"chats":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string","enum":["dialog","group","channel","favorites"],"example":"dialog"},"id":{"type":"string","example":"JC0TvKi3f2bIQtBcW1jIn"},"photoUrl":{"type":"string","example":"https://dev.iambig.ai/public/gb24ixCWLL25S-jtzYck7"},"name":{"type":"string","example":"Серёжа"},"lastMessageText":{"type":"string","example":"Hi"},"lastMessageTime":{"type":"number","example":1710436789},"lastMessageAuthor":{"type":"string","example":"Серёжа"},"lastMessageStatus":{"type":"string","enum":["read","unread","undelivered"]},"missed":{"type":"number","description":"missed messages count","example":1},"verified":{"type":"boolean"}},"required":["type","id","name","lastMessageText","lastMessageTime","lastMessageStatus"]}}},"required":["chats"]}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal Server Error"}}},"post":{"tags":["chats"],"summary":"Create a new chat group","security":[{"BearerAuth":[]}],"operationId":"post_CreateChatHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string"},"imgUrl":{"type":"string"},"participants":{"type":"array","items":{"type":"string"}}},"required":["name","participants"]}}}},"responses":{"200":{"description":"Group chat created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"groupId":{"type":"string"},"name":{"type":"string"},"imgUrl":{"type":"string"},"participants":{"type":"array","items":{"type":"string"}}},"required":["groupId","name","participants"]}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}}}},"/deviceToken":{"post":{"tags":["device"],"summary":"Store Apple device token with fingerprint","security":[{"BearerAuth":[]}],"operationId":"post_StoreDeviceTokenHandler","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"deviceToken":{"type":"string"},"fingerprint":{"type":"string"}},"required":["deviceToken","fingerprint"]}}}},"responses":{"200":{"description":"Device token stored successfully"},"400":{"description":"Bad request"}}}},"/network":{"get":{"summary":"Network info","tags":["debug"],"security":[],"operationId":"get_NetworkInfoHandler","responses":{"200":{"description":"network info","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/websocket":{"get":{"security":[{"BearerAuth":[]}],"operationId":"get_WebsocketHandler","responses":{"200":{"description":"Successfull response","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"*":{"options":{"operationId":"options_CORS","responses":{"200":{"description":"Successfull response","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/avatar/{userId}":{"get":{"summary":"Get user avatar by userId","tags":["user"],"operationId":"get_GetAvatarHandler","parameters":[{"schema":{"type":"string"},"required":true,"name":"userId","in":"path"}],"responses":{"200":{"description":"Avatar retrieved successfully","content":{"application/json":{"schema":{"type":"string"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"userId is required"}},"required":["error"]}}}},"404":{"description":"Avatar not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Avatar not found"}},"required":["error"]}}}},"500":{"description":"Server Error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Failed to retrieve avatar"}},"required":["error"]}}}}}}},"/deviceTokens/{userId}":{"get":{"summary":"Get device tokens for a user","tags":["device"],"operationId":"get_GetDeviceTokensHandler","parameters":[{"schema":{"type":"string","description":"The ID of the user"},"required":true,"description":"The ID of the user","name":"userId","in":"path"}],"responses":{"200":{"description":"Device tokens retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}}},"404":{"description":"User not found"},"500":{"description":"Internal Server Error"}}}}},"webhooks":{}}