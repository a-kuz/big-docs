{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"WebSocket overview","text":"<p>This document provides an overview of the WebSocket protocol, which is used for messaging</p>"},{"location":"#message-types","title":"Message types","text":"<pre><code>  sequenceDiagram\n\n\n    Client-&gt;&gt;Server: Requests\n    activate Server\n    Server--&gt;&gt;Client: Responses\n    deactivate Server\n\n    Server-&gt;&gt;Client: Events\n    Client-&gt;&gt;Server: Events\n</code></pre>"},{"location":"#1-client-request","title":"1. Client Request","text":"<p>Clients send requests to perform actions like sending, editing, or deleting messages. Each request includes a timestamp and a unique identifier for tracking and synchronization.</p> Field Type Example type const \"request\" timestamp number 1700000000000 id string \"req001\" payloadType \"new\", \u201cedit\u201d, \u201cdelete\u201d, ... see requests payload any <code>{\"chatId\":\"User2\",\"message\":\"Hi from User1!\"}</code>"},{"location":"#2-server-response","title":"2. Server Response","text":"<p>The server sends an response message in response to client requests,confirming that the requested action has been processed.</p> Field Type Example type const \"response\" timestamp number 1700000000000 id string \"req001\" payload any <code>{\"messageId\":5}</code>"},{"location":"#3-server-event","title":"3. Server Event","text":"<p>Server events are notifications or updates that are pushed to other clients involved in the chat, such as new messages or changes to existing ones.</p> Field Type Example type const \"event\" timestamp number id string eventType Event payload ServerEventPayload"},{"location":"client-events/","title":"Client Event Schemas","text":""},{"location":"client-events/#typing","title":"typing","text":"Field Type Example Possible Values chatId string \"User2\" Chat IDs"},{"location":"client-requests/","title":"requests","text":"<p>The following tables represent the structure for various payloads used in the WebSocket protocol.</p>"},{"location":"client-requests/#payload-types","title":"payload types","text":"<ul> <li>new</li> <li>edit</li> <li>delete</li> <li>dlvrd</li> <li>read</li> <li>getMessage</li> <li>getMessages</li> <li>getChat</li> </ul>"},{"location":"client-requests/#new","title":"new","text":"<p>New Message Request Payload</p> field Type Example Possible Values chatId string \"User2\" Chat IDs message string \"Hello, World!\" Any string attachments array See \"Attachments\" Array of Attachment objects"},{"location":"client-requests/#edit","title":"edit","text":"Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs message string \"Updated message text\" Any string"},{"location":"client-requests/#delete","title":"delete","text":"Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs"},{"location":"client-requests/#dlvrd","title":"dlvrd","text":"<p>set mark \"delivered\" to message</p> Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs"},{"location":"client-requests/#read","title":"read","text":"<p>set mark \"read\" to message</p> Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs"},{"location":"client-requests/#getmessage","title":"getMessage","text":"<p>request payload schema:</p> Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs <p>response payload schema:</p> Field Type Example Possible Values messageId integer 123 Message IDs message string \"Hello\" Any string atttachments array See \"Attachments\" Array of Attachment objects sender string \"User1\" User IDs read? timestamp 123456789 Timestamp delivered? timestamp 123456789 Timestamp createdAt timestamp 123456789 Timestamp updatedAt timestamp 123456789 Timestamp"},{"location":"client-requests/#getmessages","title":"getMessages","text":"<p>request payload schema:</p> <p>Message:</p> Field Type Example Possible Values chatId string \"User2\" Chat IDs endId? integer 199 Message IDs count integer 50 1 - 100 <p>to get 50 messages from the end of the chat:**</p> <pre><code>{\n  \"chatId\": \"User2\",\n  \"count\": 50\n}\n</code></pre> <p>to get messages with ids 80-100:</p> <pre><code>{\n  \"chatId\": \"User2\",\n  \"count\": 20,\n  \"endId\": 100\n}\n</code></pre> <p>response payload schema:</p> <p>Message[]</p>"},{"location":"client-requests/#getchat","title":"getChat","text":"<p>request payload schema:</p> Field Type Example Possible Values chatId string \"User2\" Chat IDs <p>response payload schema:</p> Field Type Example Possible Values chatId string \"User2\" Chat IDs type string \"dialog\" \"dialog\", \"group\", \"channel\" firstName? string \"Alexander\" lastName? string \"Kuzopi\" username? string \"User2\" phoneNumber? string \"User2\" groupName? string \"User2\" lastId? int 1000 unreadCount? int 1000"},{"location":"dialog-ids/","title":"Dialog ids","text":""},{"location":"dialog-ids/#dialogs-visual-schema","title":"Dialogs visual schema","text":"<pre><code>sequenceDiagram\n    participant User1\n    participant Server\n    participant User2\n\n    Note over User1, User2: for User1 chatId is always 'User2',&lt;br/&gt; for User2 chatId is always 'User1'\n\n    User1-&gt;&gt;Server: Send message \"Hi user2\"&lt;br/&gt;(chatId: 'User2')\n    Server-&gt;&gt;User1: Event \"Hi user2\"&lt;br/&gt;(chatId: 'User2')\n    Server-&gt;&gt;User2: Event \"Hi user2\"&lt;br/&gt;(chatId: 'User1')\n</code></pre>"},{"location":"examples/","title":"Examples","text":""},{"location":"examples/#example-sending-a-new-message-with-attachments","title":"Example: Sending a New Message with Attachments","text":"<p>Client to Server: User1 Sends a Message with an Image to User2</p> <pre><code>{\n  \"type\": \"request\",\n  \"timestamp\": 1700300000000,\n  \"id\": \"req004\",\n  \"payloadType\": \"newMessage\",\n  \"payload\": {\n    \"chatId\": \"User2\",\n    \"message\": \"Check out this photo!\",\n    \"attachments\": [\n      {\n        \"type\": \"image\",\n        \"id\": \"img123\",\n        \"filename\": \"photo.jpg\",\n        \"url\": \"&lt;http://example.com/photo.jpg&gt;\",\n        \"payload\": {\n          \"mimetype\": \"image/jpeg\",\n          \"width\": 1024,\n          \"height\": 768,\n          \"size\": 204800\n        }\n      }\n    ]\n  }\n}\n</code></pre> <p>Server to User2: New Message Event with Image</p> <pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700300000100,\n  \"id\": \"evt004\",\n  \"eventType\": \"newMessage\",\n  \"payload\": {\n    \"chatId\": \"User1\",\n    \"userId\": \"User1\",\n    \"messageId\": 125,\n    \"message\": \"Check out this photo!\",\n    \"attachments\": [\n      {\n        \"type\": \"image\",\n        \"id\": \"img123\",\n        \"filename\": \"photo.jpg\",\n        \"url\": \"&lt;http://example.com/photo.jpg&gt;\",\n        \"payload\": {\n          \"mimetype\": \"image/jpeg\",\n          \"width\": 1024,\n          \"height\": 768,\n          \"size\": 204800\n        }\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"examples/#example-user-status-notifications","title":"Example: User Status Notifications","text":""},{"location":"examples/#online-notification","title":"Online Notification","text":"<p>Server to clients: User1 Comes Online</p> <pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700400000000,\n  \"id\": \"evt005\",\n  \"eventType\": \"online\",\n  \"payload\": {\n    \"userId\": \"User1\"\n  }\n}\n</code></pre>"},{"location":"examples/#offline-notification","title":"Offline Notification","text":"<p>Server to All Clients: User1 Goes Offline</p> <pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700400000500,\n  \"id\": \"evt006\",\n  \"eventType\": \"offline\",\n  \"payload\": {\n    \"userId\": \"User1\"\n  }\n}\n</code></pre>"},{"location":"examples/#example-typing-notification","title":"Example: Typing Notification","text":""},{"location":"examples/#client-to-server-user1-is-typing-a-message-to-user2","title":"Client to Server: User1 is Typing a Message to User2","text":"<pre><code>{\n  \"type\": \"request\",\n  \"timestamp\": 1700500000000,\n  \"id\": \"req005\",\n  \"payloadType\": \"typing\",\n  \"payload\": {\n    \"chatId\": \"User2\"\n  }\n}\n</code></pre>"},{"location":"examples/#server-to-user2-typing-event-notification","title":"Server to User2: Typing Event Notification","text":"<pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700500000100,\n  \"id\": \"evt007\",\n  \"eventType\": \"typing\",\n  \"payload\": {\n    \"userId\": \"User1\",\n    \"chatId\": \"User1\"\n  }\n}\n</code></pre>"},{"location":"examples/#request-payload-examples","title":"Request Payload Examples","text":""},{"location":"examples/#1-mark-delivered-request-example","title":"1. Mark Delivered Request Example","text":"<p>Client to Server: User1 Marks a Message as Delivered to User2</p> <pre><code>{\n  \"type\": \"request\",\n  \"timestamp\": 1700200000000,\n  \"id\": \"req003\",\n  \"payloadType\": \"dlvrd\",\n  \"payload\": {\n    \"chatId\": \"User2\",\n    \"messageId\": 123\n  }\n}\n</code></pre>"},{"location":"examples/#mark-read-request-example","title":"Mark Read Request Example","text":"<p>Client to Server: User1 Marks a Message as Read to User2</p> <pre><code>{\n  \"type\": \"request\",\n  \"timestamp\": 1700250000000,\n  \"id\": \"req004\",\n  \"payloadType\": \"read\",\n  \"payload\": {\n    \"chatId\": \"User2\",\n    \"messageId\": 124\n  }\n}\n</code></pre>"},{"location":"examples/#delete-message-request-example","title":"Delete Message Request Example","text":"<p>Client to Server: User1 Requests Deletion of a Message Sent to User2</p> <pre><code>{\n  \"type\": \"request\",\n  \"timestamp\": 1700300000000,\n  \"id\": \"req005\",\n  \"payloadType\": \"delete\",\n  \"payload\": {\n    \"chatId\": \"User2\",\n    \"messageId\": 125\n  }\n}\n</code></pre>"},{"location":"examples/#server-event-examples","title":"Server Event Examples","text":""},{"location":"examples/#delivered-event-example","title":"Delivered Event Example","text":"<p>Server to User2: Notification that Message from User1 Has Been Delivered</p> <pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700200000100,\n  \"id\": \"evt003\",\n  \"eventType\": \"dlvrd\",\n  \"payload\": {\n    \"chatId\": \"User1\",\n    \"messageId\": 123\n  }\n}\n</code></pre>"},{"location":"examples/#read-event-example","title":"Read Event Example","text":"<p>Server to User2: Notification that Message from User1 Has Been Read</p> <pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700250000100,\n  \"id\": \"evt004\",\n  \"eventType\": \"read\",\n  \"payload\": {\n    \"chatId\": \"User1\",\n    \"messageId\": 124\n  }\n}\n</code></pre>"},{"location":"examples/#delete-event-example","title":"Delete Event Example","text":"<p>Server to User2: Notification that a Message from User1 Has Been Deleted</p> <pre><code>{\n  \"type\": \"event\",\n  \"timestamp\": 1700300000100,\n  \"id\": \"evt005\",\n  \"eventType\": \"delete\",\n  \"payload\": {\n    \"chatId\": \"User1\",\n    \"messageId\": 125\n  }\n}\n</code></pre>"},{"location":"server-events/","title":"Server event payloads","text":""},{"location":"server-events/#new","title":"new","text":"Field Type Example Possible Values chatId string \"User1\" Chat IDs userId string \"User1\" User IDs messageId integer 124 Message IDs message string \"Hello, World!\" Any string attachments array See \"Attachments Table\" Array of Attachment objects"},{"location":"server-events/#edit","title":"edit","text":"Field Type Example Possible Values chatId string \"User1\" Chat IDs messageId integer 124 Message IDs message string \"Updated message text\" Any string"},{"location":"server-events/#delete","title":"delete","text":"Field Type Example Possible Values chatId string \"User1\" Chat IDs messageId integer 124 Message IDs"},{"location":"server-events/#online","title":"online","text":"Field Type Example Possible Values userId string \"User1\" User IDs"},{"location":"server-events/#offline","title":"offline","text":"Field Type Example Possible Values userId string \"User1\" User IDs"},{"location":"server-events/#typing","title":"typing","text":"Field Type Example Possible Values userId string \"User2\" User IDs chatId string \"User2\" Chat IDs"},{"location":"server-events/#dlvrd","title":"dlvrd","text":"Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs timestamp integer 1700500000100"},{"location":"server-events/#read","title":"read","text":"Field Type Example Possible Values chatId string \"User2\" Chat IDs messageId integer 123 Message IDs timestamp integer 1700500000100"},{"location":"types/attachment/","title":"Attachment","text":"Field Type Example Possible Values type string \"image\" \"file\", \"image\", \"video\" id string \"file123\" Attachment IDs filename string \"greeting.png\" File names url string \"http://example.com/greeting.png\" URLs payload object See \"Specific Attachment Payloads\" below Depends on type"},{"location":"types/attachment/#specific-attachment-payloads","title":"Specific Attachment Payloads","text":""},{"location":"types/attachment/#file-payload","title":"File Payload","text":"Field Type Example Possible Values extension string \"pdf\" \"pdf\", \"txt\", \"docx\", \"xlsx\", etc. size integer 2048000 File size in bytes"},{"location":"types/attachment/#image-payload","title":"Image Payload","text":"Field Type Example Possible Values mimetype string \"image/png\" \"image/jpeg\", \"image/png\", \"image/gif\" width integer 800 Image width in pixels height integer 600 Image height in pixels size integer 350000 File size in bytes"},{"location":"types/attachment/#video-payload","title":"Video Payload","text":"Field Type Example Possible Values mimetype string \"video/mp4\" \"video/mp4\", \"video/gif\" width integer 1920 Video width in pixels height integer 1080 Video height in pixels size integer 5000000 File size in bytes duration integer 120 Duration in seconds"}]}